<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-developers/building/feature-management/channels/voice/voicemail/email-providers/mailgun-setup" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Mailgun Email Integration Setup | Connie Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://docs.connie.one/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://docs.connie.one/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://docs.connie.one/developers/building/feature-management/channels/voice/voicemail/email-providers/mailgun-setup"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Mailgun Email Integration Setup | Connie Documentation"><meta data-rh="true" name="description" content="This guide walks you through implementing the callback-and-voicemail-with-email template feature, which provides a complete voicemail solution with automated email notifications."><meta data-rh="true" property="og:description" content="This guide walks you through implementing the callback-and-voicemail-with-email template feature, which provides a complete voicemail solution with automated email notifications."><link data-rh="true" rel="icon" href="/img/logos/connie-rtc-icon.png"><link data-rh="true" rel="canonical" href="https://docs.connie.one/developers/building/feature-management/channels/voice/voicemail/email-providers/mailgun-setup"><link data-rh="true" rel="alternate" href="https://docs.connie.one/developers/building/feature-management/channels/voice/voicemail/email-providers/mailgun-setup" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.connie.one/developers/building/feature-management/channels/voice/voicemail/email-providers/mailgun-setup" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Voicemail","item":"https://docs.connie.one/category/voicemail-1"},{"@type":"ListItem","position":2,"name":"Mailgun Setup","item":"https://docs.connie.one/developers/building/feature-management/channels/voice/voicemail/email-providers/mailgun-setup"}]}</script><link rel="stylesheet" href="https://assets.twilio.com/public_assets/paste-fonts/1.5.1/fonts.css"><link rel="stylesheet" href="/assets/css/styles.a19a050f.css">
<script src="/assets/js/runtime~main.2b541e60.js" defer="defer"></script>
<script src="/assets/js/main.ddeef250.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logos/connie-rtc-icon.png" alt="Connie Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logos/connie-rtc-icon.png" alt="Connie Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Connie Documentation</b></a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/ConnieML/connieRTC-flex" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/developers/getting-started">Connie Developer</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/developers/getting-started">Getting Started</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/developers/updating-docs">Updating Documentation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/developers/building/getting-started">Getting started</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/developers/building/developer-setup">Developer setup</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/developers/building/merge-future-updates">Merge future updates</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/developers/building/twilio-profile-management">Twilio Profile Management &amp; CORS Troubleshooting</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/developers/building/feature-management/overview">Feature management</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/developers/building/feature-management/overview">Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/developers/building/feature-management/channels/voice/overview">Channels</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/developers/building/feature-management/channels/voice/overview">Voice</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/developers/building/feature-management/channels/voice/overview">Voice Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-5 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/developers/building/feature-management/channels/voice/troubleshooting">Common Issues</a><button aria-label="Expand sidebar category &#x27;Common Issues&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/developers/building/feature-management/channels/voice/voice-direct-architecture">Voice Direct Architecture</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-5 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/category/voicemail-1">Voicemail</a><button aria-label="Collapse sidebar category &#x27;Voicemail&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-6 menu__list-item"><a class="menu__link" tabindex="0" href="/developers/building/feature-management/channels/voice/voicemail/voicemail-implementation-guide">Implementation Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-6 menu__list-item"><a class="menu__link" tabindex="0" href="/developers/building/feature-management/channels/voice/voicemail">Choose Email Provider</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-6 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/developers/building/feature-management/channels/voice/voicemail/email-providers/mailgun-setup">Email Providers</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-7 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/developers/building/feature-management/channels/voice/voicemail/email-providers/mailgun-setup">Mailgun Setup</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-7 menu__list-item"><a class="menu__link" tabindex="0" href="/developers/building/feature-management/channels/voice/voicemail/email-providers/sendgrid-setup">SendGrid Setup</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-7 menu__list-item"><a class="menu__link" tabindex="0" href="/developers/building/feature-management/channels/voice/voicemail/email-providers/advanced-email-config">Advanced Email Config</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-7 menu__list-item"><a class="menu__link" tabindex="0" href="/developers/building/feature-management/channels/voice/voicemail/email-providers/email-customization">Email Customization</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-7 menu__list-item"><a class="menu__link" tabindex="0" href="/developers/building/feature-management/channels/voice/voicemail/email-providers/monitoring-guide">Monitoring Guide</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-6 menu__list-item"><a class="menu__link" tabindex="0" href="/developers/building/feature-management/channels/voice/voicemail/voicemail-only-configuration">Voicemail-Only Configuration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-6 menu__list-item"><a class="menu__link" tabindex="0" href="/developers/building/feature-management/channels/voice/voicemail/basic-voicemail-setup">Basic Voicemail Setup</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-6 menu__list-item"><a class="menu__link" tabindex="0" href="/developers/building/feature-management/channels/voice/voicemail/callback-voicemail-setup">Callback + Voicemail Setup</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-5 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" tabindex="0" href="/developers/building/feature-management/channels/voice/add-ons/overview">Add-ons</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-6 menu__list-item"><a class="menu__link" tabindex="0" href="/developers/building/feature-management/channels/voice/add-ons/overview">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-6 menu__list-item"><a class="menu__link" tabindex="0" href="/developers/building/feature-management/channels/voice/add-ons/email-notifications">Email Notifications</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-6 menu__list-item"><a class="menu__link" tabindex="0" href="/developers/building/feature-management/channels/voice/add-ons/ivr-functions">IVR Functions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-6 menu__list-item"><a class="menu__link" tabindex="0" href="/developers/building/feature-management/channels/voice/add-ons/custom-greetings">Custom Greetings</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-6 menu__list-item"><a class="menu__link" tabindex="0" href="/developers/building/feature-management/channels/voice/add-ons/transcription">Transcription</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-6 menu__list-item"><a class="menu__link" tabindex="0" href="/developers/building/feature-management/channels/voice/add-ons/integrations">Integrations</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-5 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/developers/building/feature-management/channels/voice/deployment">Deployment</a><button aria-label="Collapse sidebar category &#x27;Deployment&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-6 menu__list-item"><a class="menu__link" tabindex="0" href="/developers/building/feature-management/channels/voice/deployment/direct-plus-deployment-guide">Direct+ Deployment Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-6 menu__list-item"><a class="menu__link" tabindex="0" href="/developers/building/feature-management/channels/voice/deployment/pre-deployment-checklist">Pre-Deployment Checklist</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-6 menu__list-item"><a class="menu__link" tabindex="0" href="/developers/building/feature-management/channels/voice/deployment/configuration-template">Configuration Template</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-6 menu__list-item"><a class="menu__link" tabindex="0" href="/developers/building/feature-management/channels/voice/deployment/assets">Direct+ Deployment Assets</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/developers/building/feature-management/channels/voice/examples">Examples</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/developers/building/feature-management/channels/voice/voicemail-implementation-guide">Legacy Implementation Guide</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-5 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/developers/building/feature-management/channels/voice/workflows/direct">workflows</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" tabindex="0" href="/developers/building/feature-management/channels/web/implementation-guide">Web Forms</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/developers/building/feature-management/channels/web/implementation-guide">Implementation Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/developers/building/feature-management/channels/web/choose-web-forms-provider">Choose Provider</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" tabindex="0" href="/developers/building/feature-management/channels/fax/implementation-guide">Fax</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/developers/building/feature-management/channels/fax/implementation-guide">Implementation Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/developers/building/feature-management/channels/fax/choose-fax-provider">Choose Provider</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/developers/building/feature-management/add-new-feature">Add new feature</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/developers/building/feature-management/remove-features">Remove features</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/developers/building/feature-management/template-as-shell">Create standalone feature</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/developers/building/flex-hooks/overview">Flex hooks</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/developers/building/template-utilities/apiservice">Template utilities</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/developers/building/deployment/ci-deployment">Deployment</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/developers/frontend/overview">Frontend Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/developers/backend/overview">Backend Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" tabindex="0" href="/developers/backend/fax/sinch-implementation">Fax Integration</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/developers/backend/fax/sinch-implementation">Sinch Fax API</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" tabindex="0" href="/developers/backend/web/adobe-implementation">Web Forms</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/developers/backend/web/adobe-implementation">Adobe Web Forms API</a></li></ul></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Connie Developer</span></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Feature management</span></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Channels</span></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Voice</span></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/category/voicemail-1"><span>Voicemail</span></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Email Providers</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Mailgun Setup</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Option C: Email-Enabled Voicemail Setup</h1></header>
<p>This guide walks you through implementing the <strong>callback-and-voicemail-with-email</strong> template feature, which provides a complete voicemail solution with automated email notifications.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>You&#x27;re implementing Option C</div><div class="admonitionContent_BuS1"><div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Legacy Documentation</div><div class="admonitionContent_BuS1"><p>This guide is for existing legacy deployments. <strong>For new implementations:</strong></p><ul>
<li><a href="/developers/building/feature-management/channels/voice/add-ons/email-notifications">Email Notifications Add-On</a> - Modern email setup with Mailgun, SendGrid options</li>
</ul><p><strong>For existing deployments:</strong> Continue with the detailed setup below.</p></div></div></div></div>
<p>This is the most advanced voicemail option in the legacy architecture. If you need something simpler, see the <a href="/developers/building/feature-management/channels/voice/voicemail/voicemail-implementation-guide">Legacy Implementation Guide</a> for other options.
:::</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-youre-building">What You&#x27;re Building<a href="#what-youre-building" class="hash-link" aria-label="Direct link to What You&#x27;re Building" title="Direct link to What You&#x27;re Building">​</a></h2>
<p><strong>Caller Experience:</strong></p>
<ol>
<li>Calls your client&#x27;s number</li>
<li>Waits in queue with hold music and options</li>
<li>Can press * anytime to request callback OR leave voicemail</li>
<li>Professional in-queue experience</li>
</ol>
<p><strong>Administrator Experience:</strong></p>
<ol>
<li>Receives instant email notification when voicemails are left</li>
<li>Email includes audio recording as attachment</li>
<li>Complete transcription included in email</li>
<li>Professional formatting with all call details</li>
</ol>
<p><strong>Agent Experience:</strong></p>
<ol>
<li>Voicemail tasks appear normally in Flex</li>
<li>All standard callback and voicemail handling</li>
<li>No workflow changes required</li>
</ol>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="prerequisites">Prerequisites<a href="#prerequisites" class="hash-link" aria-label="Direct link to Prerequisites" title="Direct link to Prerequisites">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="required-access">Required Access:<a href="#required-access" class="hash-link" aria-label="Direct link to Required Access:" title="Direct link to Required Access:">​</a></h3>
<ul>
<li>✅ Admin access to your organization&#x27;s Connie deployment</li>
<li>✅ Access to your client&#x27;s domain DNS settings</li>
<li>✅ Your client&#x27;s admin email address</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="accounts-needed">Accounts Needed:<a href="#accounts-needed" class="hash-link" aria-label="Direct link to Accounts Needed:" title="Direct link to Accounts Needed:">​</a></h3>
<ul>
<li>✅ Mailgun account (free tier supports 100 emails/day)</li>
<li>✅ Domain registrar access (GoDaddy, Namecheap, etc.)</li>
</ul>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>New to Connie?</div><div class="admonitionContent_BuS1"><p>This guide assumes you have basic familiarity with environment configuration. If you&#x27;re new, allow extra time for the DNS setup steps.</p></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="step-1-client-information-gathering">Step 1: Client Information Gathering<a href="#step-1-client-information-gathering" class="hash-link" aria-label="Direct link to Step 1: Client Information Gathering" title="Direct link to Step 1: Client Information Gathering">​</a></h2>
<p>Before starting, collect this information from your client:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># CLIENT CONFIGURATION TEMPLATE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Copy this and fill in your client&#x27;s actual values</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CLIENT_ORGANIZATION_NAME=&quot;Your Client&#x27;s Organization Name&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CLIENT_DOMAIN=&quot;clientdomain.com&quot; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CLIENT_ADMIN_EMAIL=&quot;admin@clientdomain.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CLIENT_PHONE_NUMBER=&quot;+18005551234&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># You&#x27;ll create these in the next steps:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MAILGUN_DOMAIN=&quot;voicemail.clientdomain.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MAILGUN_API_KEY=&quot;[Will be generated]&quot;</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="step-2-mailgun-account-setup">Step 2: Mailgun Account Setup<a href="#step-2-mailgun-account-setup" class="hash-link" aria-label="Direct link to Step 2: Mailgun Account Setup" title="Direct link to Step 2: Mailgun Account Setup">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="create-mailgun-account">Create Mailgun Account<a href="#create-mailgun-account" class="hash-link" aria-label="Direct link to Create Mailgun Account" title="Direct link to Create Mailgun Account">​</a></h3>
<ol>
<li>Go to <a href="https://mailgun.com" target="_blank" rel="noopener noreferrer">mailgun.com</a> and create an account</li>
<li>Choose <strong>US</strong> region (recommended for most clients)</li>
<li>Verify your email and complete account setup</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="add-your-clients-domain">Add Your Client&#x27;s Domain<a href="#add-your-clients-domain" class="hash-link" aria-label="Direct link to Add Your Client&#x27;s Domain" title="Direct link to Add Your Client&#x27;s Domain">​</a></h3>
<p><strong>Use a dedicated subdomain</strong> for best deliverability:</p>
<ol>
<li><strong>Recommended format:</strong> <code>voicemail.[clientdomain].com</code></li>
<li><strong>Example:</strong> If client domain is <code>helpinghand.org</code>, use <code>voicemail.helpinghand.org</code></li>
</ol>
<p><strong>Setup steps:</strong></p>
<ol>
<li>In Mailgun dashboard → <strong>Sending</strong> → <strong>Domains</strong></li>
<li>Click <strong>Add New Domain</strong></li>
<li>Enter: <code>voicemail.[YOUR_CLIENT_DOMAIN]</code></li>
<li>Select <strong>US</strong> region</li>
<li>Click <strong>Add Domain</strong></li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="configure-dns-records">Configure DNS Records<a href="#configure-dns-records" class="hash-link" aria-label="Direct link to Configure DNS Records" title="Direct link to Configure DNS Records">​</a></h3>
<p>Mailgun will provide DNS records. Add these to your client&#x27;s domain:</p>
<div class="language-dns codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-dns codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Example DNS records (yours will be different)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Type: TXT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Name: voicemail.helpinghand.org</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Value: v=spf1 include:mailgun.org ~all</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Type: TXT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Name: smtp._domainkey.voicemail.helpinghand.org  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Value: k=rsa; p=MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Type: CNAME</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Name: email.voicemail.helpinghand.org</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Value: mailgun.org</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Type: MX</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Name: voicemail.helpinghand.org</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Value: 10 mxa.mailgun.org</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>DNS Propagation Time</div><div class="admonitionContent_BuS1"><p>DNS changes take 1-24 hours to propagate. You can check verification status in Mailgun dashboard under <strong>Domains</strong> → <strong>Domain Verification</strong>.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="get-your-sending-api-key">Get Your Sending API Key<a href="#get-your-sending-api-key" class="hash-link" aria-label="Direct link to Get Your Sending API Key" title="Direct link to Get Your Sending API Key">​</a></h3>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Critical: Use Domain-Specific Sending Key</div><div class="admonitionContent_BuS1"><p><strong>Do NOT use the Private API key from Settings → API Keys.</strong> You need a domain-specific sending key for the email functionality to work properly.</p></div></div>
<p>After your domain is created and DNS records are configured:</p>
<ol>
<li><strong>Navigate to your domain:</strong> Mailgun dashboard → <strong>Sending</strong> → <strong>Domains</strong></li>
<li><strong>Click on your domain</strong> (e.g., <code>voicemail.clientdomain.com</code>)</li>
<li><strong>Go to Domain Settings:</strong> Click <strong>Domain settings</strong> button</li>
<li><strong>Access Sending Keys:</strong> Click the <strong>Sending keys</strong> tab</li>
</ol>
<p><img decoding="async" loading="lazy" alt="Mailgun Domain Settings - Sending Keys Tab" src="/assets/images/mailgun-sending-keys-tab-9d114cbbe134b95782b14c2e11000fab.png" width="3800" height="1868" class="img_ev3q"></p>
<ol start="5">
<li><strong>Create a sending key:</strong> Click <strong>Add sending key</strong></li>
<li><strong>Copy both values:</strong>
<ul>
<li><strong>Key ID</strong> (e.g., <code>45de04af-85e71f21</code>)</li>
<li><strong>API Send Key</strong> (long string starting with various prefixes)</li>
</ul>
</li>
</ol>
<p><img decoding="async" loading="lazy" alt="Mailgun Sending Key Details" src="/assets/images/mailgun-sending-key-details-d3f5c11c672db4f3c327191434837466.png" width="3804" height="1886" class="img_ev3q"></p>
<ol start="7">
<li><strong>Use the API Send Key</strong> for your <code>MAILGUN_API_KEY</code> environment variable</li>
<li>Save both the Key ID and API Send Key in a secure location</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="test-mailgun-setup">Test Mailgun Setup<a href="#test-mailgun-setup" class="hash-link" aria-label="Direct link to Test Mailgun Setup" title="Direct link to Test Mailgun Setup">​</a></h3>
<div class="theme-admonition theme-admonition-danger admonition_xJq3 alert alert--danger"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>CRITICAL: Test API Before Deployment</div><div class="admonitionContent_BuS1"><p><strong>This step prevents 90% of deployment failures.</strong> You MUST verify API credentials work before proceeding.</p></div></div>
<p><strong>Use this exact command to test:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># TEST MAILGUN API BEFORE DEPLOYMENT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl -s -w &quot;\nHTTP Status: %{http_code}\n&quot; --user &quot;api:[YOUR_SENDING_API_KEY]&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    https://api.mailgun.net/v3/[YOUR_DOMAIN]/messages \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -F from=&#x27;Test &lt;test@[YOUR_DOMAIN]&gt;&#x27; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -F to=&#x27;[ADMIN_EMAIL]&#x27; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -F subject=&#x27;Pre-Deployment API Test&#x27; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -F text=&#x27;If you receive this, Mailgun API is working correctly.&#x27;</span><br></span></code></pre></div></div>
<p><strong>Expected result:</strong></p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token property" style="color:#36acaa">&quot;id&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;&lt;20250722104855.38483d1186b94dc9@yourdomain.com&gt;&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token property" style="color:#36acaa">&quot;message&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;Queued. Thank you.&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">HTTP Status</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">200</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-danger admonition_xJq3 alert alert--danger"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>STOP if you get:</div><div class="admonitionContent_BuS1"><ul>
<li><strong>HTTP 401</strong>: Wrong API key - use domain-specific sending key</li>
<li><strong>HTTP 404</strong>: Domain not found - check domain configuration</li>
<li><strong>Any other error</strong>: Do NOT proceed with deployment</li>
</ul></div></div>
<p><strong>API Key Type Verification:</strong></p>
<ul>
<li>✅ <strong>Domain Sending Key</strong>: <code>65cca1c374d5df6329441cabc102ac86-45de04af-f8ba43f2</code></li>
<li>❌ <strong>Private API Key</strong>: <code>key-1234567890abcdef</code> (DON&#x27;T USE THIS)</li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="step-3-pre-deployment-checklist">Step 3: Pre-Deployment Checklist<a href="#step-3-pre-deployment-checklist" class="hash-link" aria-label="Direct link to Step 3: Pre-Deployment Checklist" title="Direct link to Step 3: Pre-Deployment Checklist">​</a></h2>
<div class="theme-admonition theme-admonition-danger admonition_xJq3 alert alert--danger"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>STOP: Complete This Checklist First</div><div class="admonitionContent_BuS1"><p>Before proceeding, ensure you have ALL of the following information:</p></div></div>
<p><strong>✅ Twilio Account Details:</strong></p>
<ul class="contains-task-list containsTaskList_mC6p">
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Account SID (format: <code>AC...</code>)</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Auth Token</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Twilio CLI profile configured and active</li>
</ul>
<p><strong>✅ Twilio Flex Configuration:</strong></p>
<ul class="contains-task-list containsTaskList_mC6p">
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Workspace SID (format: <code>WS...</code>)</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->&quot;Assign to Anyone&quot; Workflow SID (format: <code>WW...</code>)</li>
</ul>
<p><strong>✅ Mailgun Configuration:</strong></p>
<ul class="contains-task-list containsTaskList_mC6p">
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Domain verified (DNS records propagated)</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->API test successful (Step 2)</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Domain-specific sending API key saved</li>
</ul>
<p><strong>✅ Client Information:</strong></p>
<ul class="contains-task-list containsTaskList_mC6p">
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Phone number to configure</li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Admin email address(es) for notifications</li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="step-4-configure-template-feature">Step 4: Configure Template Feature<a href="#step-4-configure-template-feature" class="hash-link" aria-label="Direct link to Step 4: Configure Template Feature" title="Direct link to Step 4: Configure Template Feature">​</a></h2>
<p>The voicemail-with-email functionality is <strong>already built into your ConnieRTC template</strong>. You just need to configure it.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="update-environment-variables">Update Environment Variables<a href="#update-environment-variables" class="hash-link" aria-label="Direct link to Update Environment Variables" title="Direct link to Update Environment Variables">​</a></h3>
<p>In your Connie deployment, add these environment variables to Twilio Functions:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># REQUIRED ENVIRONMENT VARIABLES</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Add these to your Twilio Functions environment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ADMIN_EMAIL=admin@clientdomain.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MAILGUN_DOMAIN=voicemail.clientdomain.com  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MAILGUN_API_KEY=your-mailgun-sending-api-key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># For multiple admin emails (separate emails sent to each):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># ADMIN_EMAIL=admin1@domain.com,admin2@domain.com</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>Use the Sending API Key</div><div class="admonitionContent_BuS1"><p>The <code>MAILGUN_API_KEY</code> must be the <strong>API Send Key</strong> from the domain&#x27;s Sending keys tab, NOT the Private API key from Settings → API Keys.</p></div></div>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Multiple Admin Emails</div><div class="admonitionContent_BuS1"><p>To send notifications to multiple administrators, use comma-separated emails. The system sends <strong>separate emails</strong> to each recipient for better reliability.</p></div></div>
<p><strong>How to add environment variables:</strong></p>
<ol>
<li>Twilio Console → <strong>Functions &amp; Assets</strong> → <strong>Services</strong></li>
<li>Select your ConnieRTC serverless service</li>
<li><strong>Settings</strong> → <strong>Environment Variables</strong></li>
<li>Add the three variables above</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="update-feature-configuration">Update Feature Configuration<a href="#update-feature-configuration" class="hash-link" aria-label="Direct link to Update Feature Configuration" title="Direct link to Update Feature Configuration">​</a></h3>
<p>Enable the feature in your Flex configuration:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;features&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;callback_and_voicemail_with_email&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;enabled&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;allow_requeue&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;max_attempts&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;auto_select_task&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">&quot;enable_email_notifications&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="step-5-critical-code-update">Step 5: Critical Code Update<a href="#step-5-critical-code-update" class="hash-link" aria-label="Direct link to Step 5: Critical Code Update" title="Direct link to Step 5: Critical Code Update">​</a></h2>
<div class="theme-admonition theme-admonition-danger admonition_xJq3 alert alert--danger"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>CRITICAL: Update Workflow SID</div><div class="admonitionContent_BuS1"><p><strong>This is the #1 cause of &quot;option not available&quot; errors.</strong> You MUST update the hardcoded workflow SID before deployment.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="update-wait-experience-function">Update Wait Experience Function<a href="#update-wait-experience-function" class="hash-link" aria-label="Direct link to Update Wait Experience Function" title="Direct link to Update Wait Experience Function">​</a></h3>
<p><strong>File</strong>: <code>/serverless-functions/src/functions/features/callback-and-voicemail-with-email/studio/wait-experience.protected.js</code><br>
<strong>Line</strong>: ~135</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// TEMPORARY FIX: Hardcode workflow SID to bypass buggy queue friendlyName logic</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> enqueuedWorkflowSid </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;WW...&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// YOUR &quot;Assign to Anyone&quot; workflow SID</span><br></span></code></pre></div></div>
<p><strong>How to find your workflow SID:</strong></p>
<ol>
<li>Twilio Console → <strong>TaskRouter</strong> → <strong>Workspaces</strong></li>
<li>Select your Flex workspace</li>
<li>Click <strong>Workflows</strong></li>
<li>Find &quot;Assign to Anyone&quot; workflow</li>
<li>Copy the SID (starts with <code>WW</code>)</li>
</ol>
<p><strong>Example:</strong></p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Before (will cause failures):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> enqueuedWorkflowSid </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;WW3657f8c5b384cdad9c6d37cbaedd1013&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// HHOVV workflow</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// After (updated for your account):</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> enqueuedWorkflowSid </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;WW68ed6f6bc555f21e436810af747722a9&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Your workflow</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="step-6-deploy-the-implementation">Step 6: Deploy the Implementation<a href="#step-6-deploy-the-implementation" class="hash-link" aria-label="Direct link to Step 6: Deploy the Implementation" title="Direct link to Step 6: Deploy the Implementation">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="deploy-serverless-functions">Deploy Serverless Functions<a href="#deploy-serverless-functions" class="hash-link" aria-label="Direct link to Deploy Serverless Functions" title="Direct link to Deploy Serverless Functions">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Navigate to your ConnieRTC template directory</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd serverless-functions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Deploy the updated functions with your new environment variables</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">npm run deploy</span><br></span></code></pre></div></div>
<p><strong>Deployment output will show:</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">domain            custom-flex-extensions-serverless-XXXX-dev.twil.io</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">protected /features/callback-and-voicemail-with-email/studio/send-voicemail-email</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">protected /features/callback-and-voicemail-with-email/studio/wait-experience</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Note Your Deployment Domain</div><div class="admonitionContent_BuS1"><p>Copy the domain URL (e.g., <code>custom-flex-extensions-serverless-4044-dev.twil.io</code>). You&#x27;ll need this for Studio Flow configuration and monitoring.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="verify-environment-variables-deployed">Verify Environment Variables Deployed<a href="#verify-environment-variables-deployed" class="hash-link" aria-label="Direct link to Verify Environment Variables Deployed" title="Direct link to Verify Environment Variables Deployed">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># List deployed environment variables</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">twilio api:serverless:v1:services:environments:variables:list \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --service-sid ZS... \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --environment-sid ZE...</span><br></span></code></pre></div></div>
<p><strong>Look for:</strong></p>
<ul>
<li><code>ADMIN_EMAIL</code></li>
<li><code>MAILGUN_DOMAIN</code></li>
<li><code>MAILGUN_API_KEY</code></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="apply-infrastructure-changes">Apply Infrastructure Changes<a href="#apply-infrastructure-changes" class="hash-link" aria-label="Direct link to Apply Infrastructure Changes" title="Direct link to Apply Infrastructure Changes">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Navigate to terraform directory</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd infra-as-code/terraform/environments/default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Enable the callback-and-voicemail-with-email module in your tfvars</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Add this line to your local.tfvars:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># callback_and_voicemail_with_email_enabled = true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Apply the changes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">terraform plan -var-file=&quot;local.tfvars&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">terraform apply -var-file=&quot;local.tfvars&quot;</span><br></span></code></pre></div></div>
<p>This creates:</p>
<ul>
<li>✅ TaskRouter workflow for callback/voicemail routing</li>
<li>✅ Studio Flow with email integration</li>
<li>✅ All required serverless functions</li>
</ul>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Correct Terminology</div><div class="admonitionContent_BuS1"><p>In the Studio Flow Send to Flex widget, the field is called <strong>&quot;Hold Music TwiML URL&quot;</strong> (NOT &quot;Wait URL&quot;). This URL handles the caller experience while waiting in queue.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="connect-to-phone-number">Connect to Phone Number<a href="#connect-to-phone-number" class="hash-link" aria-label="Direct link to Connect to Phone Number" title="Direct link to Connect to Phone Number">​</a></h3><ol>
<li>Twilio Console → <strong>Phone Numbers</strong> → <strong>Active Numbers</strong></li>
<li>Click your client&#x27;s phone number</li>
<li><strong>Voice Configuration</strong> → <strong>A call comes in</strong></li>
<li>Select the new Studio Flow: <strong>&quot;Template Example Callback With Email Flow&quot;</strong></li>
<li>Save configuration</li>
</ol><div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Studio Flow Not Appearing?</div><div class="admonitionContent_BuS1"><p>If the Studio Flow doesn&#x27;t appear in the dropdown, use the CLI method:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Create flow JSON file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cat &gt; callback-voicemail-email-flow.json &lt;&lt; &#x27;EOF&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;description&quot;: &quot;Callback and Voicemail with Email Flow&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;states&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;name&quot;: &quot;Trigger&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;type&quot;: &quot;trigger&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;transitions&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {&quot;event&quot;: &quot;incomingMessage&quot;},</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {&quot;next&quot;: &quot;send_to_flex_1&quot;, &quot;event&quot;: &quot;incomingCall&quot;},</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {&quot;event&quot;: &quot;incomingConversationMessage&quot;},</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {&quot;event&quot;: &quot;incomingRequest&quot;},</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {&quot;event&quot;: &quot;incomingParent&quot;}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;properties&quot;: {&quot;offset&quot;: {&quot;x&quot;: -70, &quot;y&quot;: -60}}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;name&quot;: &quot;send_to_flex_1&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;type&quot;: &quot;send-to-flex&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;transitions&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {&quot;event&quot;: &quot;callComplete&quot;},</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {&quot;event&quot;: &quot;failedToEnqueue&quot;},</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {&quot;event&quot;: &quot;callFailure&quot;}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;properties&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;waitUrl&quot;: &quot;https://YOUR-DEPLOYMENT-DOMAIN/features/callback-and-voicemail-with-email/studio/wait-experience&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;offset&quot;: {&quot;x&quot;: 170, &quot;y&quot;: 100},</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;workflow&quot;: &quot;YOUR-WORKFLOW-SID&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;channel&quot;: &quot;voice&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;attributes&quot;: &quot;{\&quot;call_sid\&quot;: \&quot;{{trigger.call.CallSid}}\&quot;, \&quot;callBackData\&quot;: {\&quot;attempts\&quot;: 0}}&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;waitUrlMethod&quot;: &quot;POST&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;initial_state&quot;: &quot;Trigger&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;flags&quot;: {&quot;allow_concurrent_calls&quot;: true}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EOF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Replace YOUR-DEPLOYMENT-DOMAIN and YOUR-WORKFLOW-SID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Create the flow</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">twilio api:studio:v2:flows:create \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --friendly-name &quot;Callback and Voicemail with Email Flow&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --status published \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --definition &quot;$(cat callback-voicemail-email-flow.json)&quot;</span><br></span></code></pre></div></div></div></div></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="step-7-automated-testing">Step 7: Automated Testing<a href="#step-7-automated-testing" class="hash-link" aria-label="Direct link to Step 7: Automated Testing" title="Direct link to Step 7: Automated Testing">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="pre-deployment-test-script">Pre-Deployment Test Script<a href="#pre-deployment-test-script" class="hash-link" aria-label="Direct link to Pre-Deployment Test Script" title="Direct link to Pre-Deployment Test Script">​</a></h3>
<p>Use the comprehensive test script to validate your deployment:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Navigate to your ConnieRTC directory</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd /path/to/connieRTC-basecamp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Set your configuration variables</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export ACCOUNT_SID=&quot;AC...&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export PHONE_NUMBER=&quot;+1...&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export ADMIN_EMAIL=&quot;admin@clientdomain.com&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export MAILGUN_DOMAIN=&quot;voicemail.clientdomain.com&quot; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export MAILGUN_API_KEY=&quot;your-domain-sending-api-key&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export DEPLOYMENT_DOMAIN=&quot;custom-flex-extensions-serverless-XXXX-dev.twil.io&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export WORKFLOW_SID=&quot;WW...&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Run the comprehensive test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">./test-voicemail-email-workflow.sh</span><br></span></code></pre></div></div>
<p><strong>The script validates:</strong></p>
<ul>
<li>✅ Twilio CLI configuration</li>
<li>✅ Mailgun API credentials</li>
<li>✅ Serverless function deployment</li>
<li>✅ Environment variables</li>
<li>✅ Studio Flow configuration</li>
</ul>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Automated Verification</div><div class="admonitionContent_BuS1"><p>This test script catches 90% of configuration issues before manual testing, saving significant troubleshooting time.</p></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="step-8-manual-test-your-implementation">Step 8: Manual Test Your Implementation<a href="#step-8-manual-test-your-implementation" class="hash-link" aria-label="Direct link to Step 8: Manual Test Your Implementation" title="Direct link to Step 8: Manual Test Your Implementation">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="complete-test-workflow">Complete Test Workflow<a href="#complete-test-workflow" class="hash-link" aria-label="Direct link to Complete Test Workflow" title="Direct link to Complete Test Workflow">​</a></h3>
<ol>
<li><strong>Call the client&#x27;s number</strong></li>
<li><strong>Listen to the greeting</strong> and wait for options</li>
<li><strong>Press * (star)</strong> during hold music</li>
<li><strong>Press 2</strong> for voicemail option</li>
<li><strong>Leave a test message</strong> (say your name and timestamp)</li>
<li><strong>Hang up</strong></li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="expected-results">Expected Results<a href="#expected-results" class="hash-link" aria-label="Direct link to Expected Results" title="Direct link to Expected Results">​</a></h3>
<p><strong>In Flex:</strong></p>
<ul>
<li>Voicemail task appears in the queue</li>
<li>Task contains recording and transcription</li>
<li>Agents can handle normally</li>
</ul>
<p><strong>In Email:</strong></p>
<ul>
<li>Email arrives at admin address within 1-2 minutes</li>
<li>Subject: &quot;New Voicemail from [phone number]&quot;</li>
<li>Body includes all call details and transcription</li>
<li>.wav audio file attached</li>
</ul>
<p><strong>Sample Email Content:</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">New voicemail received:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">From: +15105551234</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">To: +18005551234</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Date: 2024-01-15T14:30:00.000Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Recording ID: REabc123...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Transcription:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hi, this is John testing the voicemail system at 2:30 PM.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">The audio recording is attached to this email.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">---</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">This is an automated message. Please do not reply.</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="step-9-production-optimization">Step 9: Production Optimization<a href="#step-9-production-optimization" class="hash-link" aria-label="Direct link to Step 9: Production Optimization" title="Direct link to Step 9: Production Optimization">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="monitoring-setup">Monitoring Setup<a href="#monitoring-setup" class="hash-link" aria-label="Direct link to Monitoring Setup" title="Direct link to Monitoring Setup">​</a></h3>
<p><strong>Function URLs for Real-Time Monitoring:</strong></p>
<ul>
<li><strong>Email Function Logs</strong>: <code>https://[YOUR-DEPLOYMENT-DOMAIN]/features/callback-and-voicemail-with-email/studio/send-voicemail-email</code></li>
<li><strong>Call Flow Logs</strong>: <code>https://[YOUR-DEPLOYMENT-DOMAIN]/features/callback-and-voicemail-with-email/studio/wait-experience</code></li>
</ul>
<p><strong>Access logs via:</strong></p>
<ol>
<li>Twilio Console → <strong>Functions &amp; Assets</strong> → <strong>Services</strong> → Your Service → <strong>Environment</strong> → <strong>Live Logs</strong></li>
<li>Or use CLI: <code>twilio serverless:logs --service-sid ZS... --environment-sid ZE...</code></li>
</ol>
<p><strong>Check these regularly:</strong></p>
<ul>
<li>Mailgun dashboard for delivery rates</li>
<li>Twilio Function logs for errors</li>
<li>DNS record status</li>
</ul>
<p><strong>Monthly maintenance:</strong></p>
<ul>
<li>Test complete voicemail-to-email flow</li>
<li>Review Mailgun usage and costs</li>
<li>Verify DNS records unchanged</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="performance-considerations">Performance Considerations<a href="#performance-considerations" class="hash-link" aria-label="Direct link to Performance Considerations" title="Direct link to Performance Considerations">​</a></h3>
<p><strong>File Size Handling:</strong></p>
<ul>
<li>Files under 20MB: Attached directly</li>
<li>Files over 20MB: Download link provided</li>
<li>Automatic timeout protection</li>
</ul>
<p><strong>Email Delivery:</strong></p>
<ul>
<li>Typical delivery: 1-5 seconds</li>
<li>Free tier: 100 emails/day</li>
<li>Paid plans available for higher volume</li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="troubleshooting">Troubleshooting<a href="#troubleshooting" class="hash-link" aria-label="Direct link to Troubleshooting" title="Direct link to Troubleshooting">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="common-failure-points--solutions">Common Failure Points &amp; Solutions<a href="#common-failure-points--solutions" class="hash-link" aria-label="Direct link to Common Failure Points &amp; Solutions" title="Direct link to Common Failure Points &amp; Solutions">​</a></h3>
<table><thead><tr><th>Error</th><th>Cause</th><th>Solution</th></tr></thead><tbody><tr><td>&quot;Option not available at this time&quot;</td><td>Wrong/missing workflow SID</td><td>Update wait-experience.protected.js line 135</td></tr><tr><td>401/403 email errors</td><td>Wrong API key type</td><td>Use domain sending key, not private key</td></tr><tr><td>Flow not in phone config</td><td>Creation failed in Console</td><td>Use CLI method in Step 5</td></tr><tr><td>No environment vars in Console</td><td>Browser cache/wrong environment</td><td>Verify with CLI, refresh browser</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="no-email-received">No Email Received<a href="#no-email-received" class="hash-link" aria-label="Direct link to No Email Received" title="Direct link to No Email Received">​</a></h3>
<p><strong>First check for authentication errors:</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Test API directly</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl -s -w &quot;\nHTTP Status: %{http_code}\n&quot; --user &quot;api:[YOUR_KEY]&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    https://api.mailgun.net/v3/[YOUR_DOMAIN]/messages \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -F from=&#x27;Test &lt;test@[YOUR_DOMAIN]&gt;&#x27; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -F to=&#x27;[ADMIN_EMAIL]&#x27; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -F subject=&#x27;Debug Test&#x27; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -F text=&#x27;Testing email delivery&#x27;</span><br></span></code></pre></div></div>
<p><strong>Check Mailgun logs:</strong></p>
<ol>
<li>Mailgun dashboard → <strong>Logs</strong></li>
<li>Look for your test email</li>
<li>Check delivery status</li>
</ol>
<p><strong>Common issues:</strong></p>
<ul>
<li>DNS records not propagated (wait 24 hours)</li>
<li>Wrong API key format (using private key instead of sending key)</li>
<li>Admin email in spam folder</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="email-without-attachment">Email Without Attachment<a href="#email-without-attachment" class="hash-link" aria-label="Direct link to Email Without Attachment" title="Direct link to Email Without Attachment">​</a></h3>
<p><strong>Check Function logs:</strong></p>
<ol>
<li>Twilio Console → <strong>Functions</strong> → <strong>Logs</strong></li>
<li>Look for voicemail function execution</li>
<li>Check for download errors</li>
</ol>
<p><strong>Common issues:</strong></p>
<ul>
<li>Recording URL not accessible</li>
<li>Network timeout during download</li>
<li>File size exceeded limits</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="voicemail-task-not-created">Voicemail Task Not Created<a href="#voicemail-task-not-created" class="hash-link" aria-label="Direct link to Voicemail Task Not Created" title="Direct link to Voicemail Task Not Created">​</a></h3>
<p><strong>This indicates email integration broke the core functionality:</strong></p>
<ol>
<li>Check Function logs for errors</li>
<li>Verify all environment variables present</li>
<li>Test with original callback-and-voicemail feature</li>
</ol>
<p><strong>Quick fix:</strong></p>
<ul>
<li>Disable email temporarily by removing ADMIN_EMAIL environment variable</li>
<li>Redeploy functions</li>
<li>Test core voicemail functionality</li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="cost-planning">Cost Planning<a href="#cost-planning" class="hash-link" aria-label="Direct link to Cost Planning" title="Direct link to Cost Planning">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="mailgun-costs">Mailgun Costs<a href="#mailgun-costs" class="hash-link" aria-label="Direct link to Mailgun Costs" title="Direct link to Mailgun Costs">​</a></h3>
<ul>
<li><strong>Free tier:</strong> 100 emails/day</li>
<li><strong>Flex plans:</strong> Start at $35/month for 1,250/month</li>
<li><strong>Pay-as-you-go:</strong> Available for variable volume</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="estimating-volume">Estimating Volume<a href="#estimating-volume" class="hash-link" aria-label="Direct link to Estimating Volume" title="Direct link to Estimating Volume">​</a></h3>
<ul>
<li>Average organization: 5-20 voicemails/day</li>
<li>High-volume organizations: 50+ voicemails/day</li>
<li>Plan accordingly for your client&#x27;s expected usage</li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="security-best-practices">Security Best Practices<a href="#security-best-practices" class="hash-link" aria-label="Direct link to Security Best Practices" title="Direct link to Security Best Practices">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="api-key-management">API Key Management<a href="#api-key-management" class="hash-link" aria-label="Direct link to API Key Management" title="Direct link to API Key Management">​</a></h3>
<ul>
<li>Store keys in Twilio Functions environment variables only</li>
<li>Never commit keys to code repositories</li>
<li>Rotate keys quarterly</li>
<li>Use separate keys for testing vs production</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="email-security">Email Security<a href="#email-security" class="hash-link" aria-label="Direct link to Email Security" title="Direct link to Email Security">​</a></h3>
<ul>
<li>Use dedicated subdomain (voicemail.domain.com)</li>
<li>Implement all DNS security records (SPF, DKIM, DMARC)</li>
<li>Monitor DNS for unauthorized changes</li>
<li>Set up proper reverse DNS</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="data-privacy">Data Privacy<a href="#data-privacy" class="hash-link" aria-label="Direct link to Data Privacy" title="Direct link to Data Privacy">​</a></h3>
<ul>
<li>Voicemail recordings contain sensitive data</li>
<li>Ensure Mailgun account complies with client&#x27;s privacy requirements</li>
<li>Consider email encryption for sensitive environments</li>
<li>Implement retention policies</li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="professional-services-available">Professional Services Available<a href="#professional-services-available" class="hash-link" aria-label="Direct link to Professional Services Available" title="Direct link to Professional Services Available">​</a></h2>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Need Implementation Help?</div><div class="admonitionContent_BuS1"><p>Our team can handle the complete setup including:</p><ul>
<li>Mailgun account configuration</li>
<li>DNS record setup</li>
<li>Template deployment and testing</li>
<li>Client training and documentation</li>
</ul><p>Contact your Connie representative for professional services options.</p></div></div>
<hr>
<p>Your client now has enterprise-grade voicemail functionality with automated email notifications and professional caller experience!</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="next-steps">Next Steps<a href="#next-steps" class="hash-link" aria-label="Direct link to Next Steps" title="Direct link to Next Steps">​</a></h2>
<ul>
<li><a href="/developers/building/feature-management/channels/voice/voicemail/email-providers/advanced-email-config">Set up additional email recipients</a></li>
<li><a href="/developers/building/feature-management/channels/voice/voicemail/email-providers/email-customization">Configure branded email templates</a></li>
<li><a href="/developers/building/feature-management/channels/voice/voicemail/email-providers/monitoring-guide">Monitor and maintain your deployment</a></li>
</ul></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/developers/building/feature-management/channels/voice/voicemail"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Choose Email Provider</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/developers/building/feature-management/channels/voice/voicemail/email-providers/sendgrid-setup"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">SendGrid Setup</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#what-youre-building" class="table-of-contents__link toc-highlight">What You&#39;re Building</a></li><li><a href="#prerequisites" class="table-of-contents__link toc-highlight">Prerequisites</a><ul><li><a href="#required-access" class="table-of-contents__link toc-highlight">Required Access:</a></li><li><a href="#accounts-needed" class="table-of-contents__link toc-highlight">Accounts Needed:</a></li></ul></li><li><a href="#step-1-client-information-gathering" class="table-of-contents__link toc-highlight">Step 1: Client Information Gathering</a></li><li><a href="#step-2-mailgun-account-setup" class="table-of-contents__link toc-highlight">Step 2: Mailgun Account Setup</a><ul><li><a href="#create-mailgun-account" class="table-of-contents__link toc-highlight">Create Mailgun Account</a></li><li><a href="#add-your-clients-domain" class="table-of-contents__link toc-highlight">Add Your Client&#39;s Domain</a></li><li><a href="#configure-dns-records" class="table-of-contents__link toc-highlight">Configure DNS Records</a></li><li><a href="#get-your-sending-api-key" class="table-of-contents__link toc-highlight">Get Your Sending API Key</a></li><li><a href="#test-mailgun-setup" class="table-of-contents__link toc-highlight">Test Mailgun Setup</a></li></ul></li><li><a href="#step-3-pre-deployment-checklist" class="table-of-contents__link toc-highlight">Step 3: Pre-Deployment Checklist</a></li><li><a href="#step-4-configure-template-feature" class="table-of-contents__link toc-highlight">Step 4: Configure Template Feature</a><ul><li><a href="#update-environment-variables" class="table-of-contents__link toc-highlight">Update Environment Variables</a></li><li><a href="#update-feature-configuration" class="table-of-contents__link toc-highlight">Update Feature Configuration</a></li></ul></li><li><a href="#step-5-critical-code-update" class="table-of-contents__link toc-highlight">Step 5: Critical Code Update</a><ul><li><a href="#update-wait-experience-function" class="table-of-contents__link toc-highlight">Update Wait Experience Function</a></li></ul></li><li><a href="#step-6-deploy-the-implementation" class="table-of-contents__link toc-highlight">Step 6: Deploy the Implementation</a><ul><li><a href="#deploy-serverless-functions" class="table-of-contents__link toc-highlight">Deploy Serverless Functions</a></li><li><a href="#verify-environment-variables-deployed" class="table-of-contents__link toc-highlight">Verify Environment Variables Deployed</a></li><li><a href="#apply-infrastructure-changes" class="table-of-contents__link toc-highlight">Apply Infrastructure Changes</a></li><li><a href="#connect-to-phone-number" class="table-of-contents__link toc-highlight">Connect to Phone Number</a></li></ul></li><li><a href="#step-7-automated-testing" class="table-of-contents__link toc-highlight">Step 7: Automated Testing</a><ul><li><a href="#pre-deployment-test-script" class="table-of-contents__link toc-highlight">Pre-Deployment Test Script</a></li></ul></li><li><a href="#step-8-manual-test-your-implementation" class="table-of-contents__link toc-highlight">Step 8: Manual Test Your Implementation</a><ul><li><a href="#complete-test-workflow" class="table-of-contents__link toc-highlight">Complete Test Workflow</a></li><li><a href="#expected-results" class="table-of-contents__link toc-highlight">Expected Results</a></li></ul></li><li><a href="#step-9-production-optimization" class="table-of-contents__link toc-highlight">Step 9: Production Optimization</a><ul><li><a href="#monitoring-setup" class="table-of-contents__link toc-highlight">Monitoring Setup</a></li><li><a href="#performance-considerations" class="table-of-contents__link toc-highlight">Performance Considerations</a></li></ul></li><li><a href="#troubleshooting" class="table-of-contents__link toc-highlight">Troubleshooting</a><ul><li><a href="#common-failure-points--solutions" class="table-of-contents__link toc-highlight">Common Failure Points &amp; Solutions</a></li><li><a href="#no-email-received" class="table-of-contents__link toc-highlight">No Email Received</a></li><li><a href="#email-without-attachment" class="table-of-contents__link toc-highlight">Email Without Attachment</a></li><li><a href="#voicemail-task-not-created" class="table-of-contents__link toc-highlight">Voicemail Task Not Created</a></li></ul></li><li><a href="#cost-planning" class="table-of-contents__link toc-highlight">Cost Planning</a><ul><li><a href="#mailgun-costs" class="table-of-contents__link toc-highlight">Mailgun Costs</a></li><li><a href="#estimating-volume" class="table-of-contents__link toc-highlight">Estimating Volume</a></li></ul></li><li><a href="#security-best-practices" class="table-of-contents__link toc-highlight">Security Best Practices</a><ul><li><a href="#api-key-management" class="table-of-contents__link toc-highlight">API Key Management</a></li><li><a href="#email-security" class="table-of-contents__link toc-highlight">Email Security</a></li><li><a href="#data-privacy" class="table-of-contents__link toc-highlight">Data Privacy</a></li></ul></li><li><a href="#professional-services-available" class="table-of-contents__link toc-highlight">Professional Services Available</a></li><li><a href="#next-steps" class="table-of-contents__link toc-highlight">Next Steps</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Connie Links</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://connie.one" target="_blank" rel="noopener noreferrer" class="footer__link-item">Learn More<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://portal.connie.team" target="_blank" rel="noopener noreferrer" class="footer__link-item">Log In<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/ConnieML/connieRTC-flex" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Connie Corp.</div></div></div></footer></div>
</body>
</html>