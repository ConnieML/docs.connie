"use strict";(self.webpackChunkflex_project_template_docs=self.webpackChunkflex_project_template_docs||[]).push([[1365],{28453:(e,n,i)=>{i.d(n,{R:()=>r,x:()=>o});var s=i(96540);const l={},t=s.createContext(l);function r(e){const n=s.useContext(t);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:r(e.components),s.createElement(t.Provider,{value:n},e.children)}},38074:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/mailgun-sending-keys-tab-9d114cbbe134b95782b14c2e11000fab.png"},64265:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>o,default:()=>h,frontMatter:()=>r,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"developers/building/feature-management/channels/voice/voicemail/email-providers/mailgun-setup","title":"Mailgun Email Integration Setup","description":"This guide walks you through implementing the callback-and-voicemail-with-email template feature, which provides a complete voicemail solution with automated email notifications.","source":"@site/docs/developers/building/feature-management/channels/voice/voicemail/email-providers/mailgun-setup.md","sourceDirName":"developers/building/feature-management/channels/voice/voicemail/email-providers","slug":"/developers/building/feature-management/channels/voice/voicemail/email-providers/mailgun-setup","permalink":"/developers/building/feature-management/channels/voice/voicemail/email-providers/mailgun-setup","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_label":"Mailgun Setup","sidebar_position":1,"title":"Mailgun Email Integration Setup"},"sidebar":"developer","previous":{"title":"Choose Email Provider","permalink":"/developers/building/feature-management/channels/voice/voicemail/"},"next":{"title":"SendGrid Setup","permalink":"/developers/building/feature-management/channels/voice/voicemail/email-providers/sendgrid-setup"}}');var l=i(74848),t=i(28453);const r={sidebar_label:"Mailgun Setup",sidebar_position:1,title:"Mailgun Email Integration Setup"},o="Option C: Email-Enabled Voicemail Setup",a={},c=[{value:"What You&#39;re Building",id:"what-youre-building",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Required Access:",id:"required-access",level:3},{value:"Accounts Needed:",id:"accounts-needed",level:3},{value:"Step 1: Client Information Gathering",id:"step-1-client-information-gathering",level:2},{value:"Step 2: Mailgun Account Setup",id:"step-2-mailgun-account-setup",level:2},{value:"Create Mailgun Account",id:"create-mailgun-account",level:3},{value:"Add Your Client&#39;s Domain",id:"add-your-clients-domain",level:3},{value:"Configure DNS Records",id:"configure-dns-records",level:3},{value:"Get Your Sending API Key",id:"get-your-sending-api-key",level:3},{value:"Test Mailgun Setup",id:"test-mailgun-setup",level:3},{value:"Step 3: Pre-Deployment Checklist",id:"step-3-pre-deployment-checklist",level:2},{value:"Step 4: Configure Template Feature",id:"step-4-configure-template-feature",level:2},{value:"Update Environment Variables",id:"update-environment-variables",level:3},{value:"Update Feature Configuration",id:"update-feature-configuration",level:3},{value:"Step 5: Critical Code Update",id:"step-5-critical-code-update",level:2},{value:"Update Wait Experience Function",id:"update-wait-experience-function",level:3},{value:"Step 6: Deploy the Implementation",id:"step-6-deploy-the-implementation",level:2},{value:"Deploy Serverless Functions",id:"deploy-serverless-functions",level:3},{value:"Verify Environment Variables Deployed",id:"verify-environment-variables-deployed",level:3},{value:"Apply Infrastructure Changes",id:"apply-infrastructure-changes",level:3},{value:"Connect to Phone Number",id:"connect-to-phone-number",level:3},{value:"Step 7: Automated Testing",id:"step-7-automated-testing",level:2},{value:"Pre-Deployment Test Script",id:"pre-deployment-test-script",level:3},{value:"Step 8: Manual Test Your Implementation",id:"step-8-manual-test-your-implementation",level:2},{value:"Complete Test Workflow",id:"complete-test-workflow",level:3},{value:"Expected Results",id:"expected-results",level:3},{value:"Step 9: Production Optimization",id:"step-9-production-optimization",level:2},{value:"Monitoring Setup",id:"monitoring-setup",level:3},{value:"Performance Considerations",id:"performance-considerations",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Common Failure Points &amp; Solutions",id:"common-failure-points--solutions",level:3},{value:"No Email Received",id:"no-email-received",level:3},{value:"Email Without Attachment",id:"email-without-attachment",level:3},{value:"Voicemail Task Not Created",id:"voicemail-task-not-created",level:3},{value:"Cost Planning",id:"cost-planning",level:2},{value:"Mailgun Costs",id:"mailgun-costs",level:3},{value:"Estimating Volume",id:"estimating-volume",level:3},{value:"Security Best Practices",id:"security-best-practices",level:2},{value:"API Key Management",id:"api-key-management",level:3},{value:"Email Security",id:"email-security",level:3},{value:"Data Privacy",id:"data-privacy",level:3},{value:"Professional Services Available",id:"professional-services-available",level:2},{value:"Next Steps",id:"next-steps",level:2}];function d(e){const n={a:"a",admonition:"admonition",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",img:"img",input:"input",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"option-c-email-enabled-voicemail-setup",children:"Option C: Email-Enabled Voicemail Setup"})}),"\n",(0,l.jsxs)(n.p,{children:["This guide walks you through implementing the ",(0,l.jsx)(n.strong,{children:"callback-and-voicemail-with-email"})," template feature, which provides a complete voicemail solution with automated email notifications."]}),"\n",(0,l.jsx)(n.admonition,{title:"You're implementing Option C",type:"info",children:(0,l.jsxs)(n.admonition,{title:"Legacy Documentation",type:"warning",children:[(0,l.jsxs)(n.p,{children:["This guide is for existing legacy deployments. ",(0,l.jsx)(n.strong,{children:"For new implementations:"})]}),(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.a,{href:"../../add-ons/email-notifications",children:"Email Notifications Add-On"})," - Modern email setup with Mailgun, SendGrid options"]}),"\n"]}),(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"For existing deployments:"})," Continue with the detailed setup below."]})]})}),"\n",(0,l.jsxs)(n.p,{children:["This is the most advanced voicemail option in the legacy architecture. If you need something simpler, see the ",(0,l.jsx)(n.a,{href:"../voicemail-implementation-guide",children:"Legacy Implementation Guide"})," for other options.\n:::"]}),"\n",(0,l.jsx)(n.h2,{id:"what-youre-building",children:"What You're Building"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Caller Experience:"})}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:"Calls your client's number"}),"\n",(0,l.jsx)(n.li,{children:"Waits in queue with hold music and options"}),"\n",(0,l.jsx)(n.li,{children:"Can press * anytime to request callback OR leave voicemail"}),"\n",(0,l.jsx)(n.li,{children:"Professional in-queue experience"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Administrator Experience:"})}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:"Receives instant email notification when voicemails are left"}),"\n",(0,l.jsx)(n.li,{children:"Email includes audio recording as attachment"}),"\n",(0,l.jsx)(n.li,{children:"Complete transcription included in email"}),"\n",(0,l.jsx)(n.li,{children:"Professional formatting with all call details"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Agent Experience:"})}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:"Voicemail tasks appear normally in Flex"}),"\n",(0,l.jsx)(n.li,{children:"All standard callback and voicemail handling"}),"\n",(0,l.jsx)(n.li,{children:"No workflow changes required"}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,l.jsx)(n.h3,{id:"required-access",children:"Required Access:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u2705 Admin access to your organization's Connie deployment"}),"\n",(0,l.jsx)(n.li,{children:"\u2705 Access to your client's domain DNS settings"}),"\n",(0,l.jsx)(n.li,{children:"\u2705 Your client's admin email address"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"accounts-needed",children:"Accounts Needed:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u2705 Mailgun account (free tier supports 100 emails/day)"}),"\n",(0,l.jsx)(n.li,{children:"\u2705 Domain registrar access (GoDaddy, Namecheap, etc.)"}),"\n"]}),"\n",(0,l.jsx)(n.admonition,{title:"New to Connie?",type:"tip",children:(0,l.jsx)(n.p,{children:"This guide assumes you have basic familiarity with environment configuration. If you're new, allow extra time for the DNS setup steps."})}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"step-1-client-information-gathering",children:"Step 1: Client Information Gathering"}),"\n",(0,l.jsx)(n.p,{children:"Before starting, collect this information from your client:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'# CLIENT CONFIGURATION TEMPLATE\n# Copy this and fill in your client\'s actual values\n\nCLIENT_ORGANIZATION_NAME="Your Client\'s Organization Name"\nCLIENT_DOMAIN="clientdomain.com" \nCLIENT_ADMIN_EMAIL="admin@clientdomain.com"\nCLIENT_PHONE_NUMBER="+18005551234"\n\n# You\'ll create these in the next steps:\nMAILGUN_DOMAIN="voicemail.clientdomain.com"\nMAILGUN_API_KEY="[Will be generated]"\n'})}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"step-2-mailgun-account-setup",children:"Step 2: Mailgun Account Setup"}),"\n",(0,l.jsx)(n.h3,{id:"create-mailgun-account",children:"Create Mailgun Account"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["Go to ",(0,l.jsx)(n.a,{href:"https://mailgun.com",children:"mailgun.com"})," and create an account"]}),"\n",(0,l.jsxs)(n.li,{children:["Choose ",(0,l.jsx)(n.strong,{children:"US"})," region (recommended for most clients)"]}),"\n",(0,l.jsx)(n.li,{children:"Verify your email and complete account setup"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"add-your-clients-domain",children:"Add Your Client's Domain"}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Use a dedicated subdomain"})," for best deliverability:"]}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Recommended format:"})," ",(0,l.jsx)(n.code,{children:"voicemail.[clientdomain].com"})]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Example:"})," If client domain is ",(0,l.jsx)(n.code,{children:"helpinghand.org"}),", use ",(0,l.jsx)(n.code,{children:"voicemail.helpinghand.org"})]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Setup steps:"})}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["In Mailgun dashboard \u2192 ",(0,l.jsx)(n.strong,{children:"Sending"})," \u2192 ",(0,l.jsx)(n.strong,{children:"Domains"})]}),"\n",(0,l.jsxs)(n.li,{children:["Click ",(0,l.jsx)(n.strong,{children:"Add New Domain"})]}),"\n",(0,l.jsxs)(n.li,{children:["Enter: ",(0,l.jsx)(n.code,{children:"voicemail.[YOUR_CLIENT_DOMAIN]"})]}),"\n",(0,l.jsxs)(n.li,{children:["Select ",(0,l.jsx)(n.strong,{children:"US"})," region"]}),"\n",(0,l.jsxs)(n.li,{children:["Click ",(0,l.jsx)(n.strong,{children:"Add Domain"})]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"configure-dns-records",children:"Configure DNS Records"}),"\n",(0,l.jsx)(n.p,{children:"Mailgun will provide DNS records. Add these to your client's domain:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-dns",children:"# Example DNS records (yours will be different)\nType: TXT\nName: voicemail.helpinghand.org\nValue: v=spf1 include:mailgun.org ~all\n\nType: TXT\nName: smtp._domainkey.voicemail.helpinghand.org  \nValue: k=rsa; p=MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQ...\n\nType: CNAME\nName: email.voicemail.helpinghand.org\nValue: mailgun.org\n\nType: MX\nName: voicemail.helpinghand.org\nValue: 10 mxa.mailgun.org\n"})}),"\n",(0,l.jsx)(n.admonition,{title:"DNS Propagation Time",type:"warning",children:(0,l.jsxs)(n.p,{children:["DNS changes take 1-24 hours to propagate. You can check verification status in Mailgun dashboard under ",(0,l.jsx)(n.strong,{children:"Domains"})," \u2192 ",(0,l.jsx)(n.strong,{children:"Domain Verification"}),"."]})}),"\n",(0,l.jsx)(n.h3,{id:"get-your-sending-api-key",children:"Get Your Sending API Key"}),"\n",(0,l.jsx)(n.admonition,{title:"Critical: Use Domain-Specific Sending Key",type:"warning",children:(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Do NOT use the Private API key from Settings \u2192 API Keys."})," You need a domain-specific sending key for the email functionality to work properly."]})}),"\n",(0,l.jsx)(n.p,{children:"After your domain is created and DNS records are configured:"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Navigate to your domain:"})," Mailgun dashboard \u2192 ",(0,l.jsx)(n.strong,{children:"Sending"})," \u2192 ",(0,l.jsx)(n.strong,{children:"Domains"})]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Click on your domain"})," (e.g., ",(0,l.jsx)(n.code,{children:"voicemail.clientdomain.com"}),")"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Go to Domain Settings:"})," Click ",(0,l.jsx)(n.strong,{children:"Domain settings"})," button"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Access Sending Keys:"})," Click the ",(0,l.jsx)(n.strong,{children:"Sending keys"})," tab"]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.img,{alt:"Mailgun Domain Settings - Sending Keys Tab",src:i(38074).A+"",width:"3800",height:"1868"})}),"\n",(0,l.jsxs)(n.ol,{start:"5",children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Create a sending key:"})," Click ",(0,l.jsx)(n.strong,{children:"Add sending key"})]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Copy both values:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Key ID"})," (e.g., ",(0,l.jsx)(n.code,{children:"45de04af-85e71f21"}),")"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"API Send Key"})," (long string starting with various prefixes)"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.img,{alt:"Mailgun Sending Key Details",src:i(90654).A+"",width:"3804",height:"1886"})}),"\n",(0,l.jsxs)(n.ol,{start:"7",children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Use the API Send Key"})," for your ",(0,l.jsx)(n.code,{children:"MAILGUN_API_KEY"})," environment variable"]}),"\n",(0,l.jsx)(n.li,{children:"Save both the Key ID and API Send Key in a secure location"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"test-mailgun-setup",children:"Test Mailgun Setup"}),"\n",(0,l.jsx)(n.admonition,{title:"CRITICAL: Test API Before Deployment",type:"danger",children:(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"This step prevents 90% of deployment failures."})," You MUST verify API credentials work before proceeding."]})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Use this exact command to test:"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# TEST MAILGUN API BEFORE DEPLOYMENT\ncurl -s -w \"\\nHTTP Status: %{http_code}\\n\" --user \"api:[YOUR_SENDING_API_KEY]\" \\\n    https://api.mailgun.net/v3/[YOUR_DOMAIN]/messages \\\n    -F from='Test <test@[YOUR_DOMAIN]>' \\\n    -F to='[ADMIN_EMAIL]' \\\n    -F subject='Pre-Deployment API Test' \\\n    -F text='If you receive this, Mailgun API is working correctly.'\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Expected result:"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json",children:'{"id":"<20250722104855.38483d1186b94dc9@yourdomain.com>","message":"Queued. Thank you."}\nHTTP Status: 200\n'})}),"\n",(0,l.jsx)(n.admonition,{title:"STOP if you get:",type:"danger",children:(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"HTTP 401"}),": Wrong API key - use domain-specific sending key"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"HTTP 404"}),": Domain not found - check domain configuration"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Any other error"}),": Do NOT proceed with deployment"]}),"\n"]})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"API Key Type Verification:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\u2705 ",(0,l.jsx)(n.strong,{children:"Domain Sending Key"}),": ",(0,l.jsx)(n.code,{children:"65cca1c374d5df6329441cabc102ac86-45de04af-f8ba43f2"})]}),"\n",(0,l.jsxs)(n.li,{children:["\u274c ",(0,l.jsx)(n.strong,{children:"Private API Key"}),": ",(0,l.jsx)(n.code,{children:"key-1234567890abcdef"})," (DON'T USE THIS)"]}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"step-3-pre-deployment-checklist",children:"Step 3: Pre-Deployment Checklist"}),"\n",(0,l.jsx)(n.admonition,{title:"STOP: Complete This Checklist First",type:"danger",children:(0,l.jsx)(n.p,{children:"Before proceeding, ensure you have ALL of the following information:"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"\u2705 Twilio Account Details:"})}),"\n",(0,l.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,l.jsxs)(n.li,{className:"task-list-item",children:[(0,l.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Account SID (format: ",(0,l.jsx)(n.code,{children:"AC..."}),")"]}),"\n",(0,l.jsxs)(n.li,{className:"task-list-item",children:[(0,l.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Auth Token"]}),"\n",(0,l.jsxs)(n.li,{className:"task-list-item",children:[(0,l.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Twilio CLI profile configured and active"]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"\u2705 Twilio Flex Configuration:"})}),"\n",(0,l.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,l.jsxs)(n.li,{className:"task-list-item",children:[(0,l.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Workspace SID (format: ",(0,l.jsx)(n.code,{children:"WS..."}),")"]}),"\n",(0,l.jsxs)(n.li,{className:"task-list-item",children:[(0,l.jsx)(n.input,{type:"checkbox",disabled:!0})," ",'"Assign to Anyone" Workflow SID (format: ',(0,l.jsx)(n.code,{children:"WW..."}),")"]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"\u2705 Mailgun Configuration:"})}),"\n",(0,l.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,l.jsxs)(n.li,{className:"task-list-item",children:[(0,l.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Domain verified (DNS records propagated)"]}),"\n",(0,l.jsxs)(n.li,{className:"task-list-item",children:[(0,l.jsx)(n.input,{type:"checkbox",disabled:!0})," ","API test successful (Step 2)"]}),"\n",(0,l.jsxs)(n.li,{className:"task-list-item",children:[(0,l.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Domain-specific sending API key saved"]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"\u2705 Client Information:"})}),"\n",(0,l.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,l.jsxs)(n.li,{className:"task-list-item",children:[(0,l.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Phone number to configure"]}),"\n",(0,l.jsxs)(n.li,{className:"task-list-item",children:[(0,l.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Admin email address(es) for notifications"]}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"step-4-configure-template-feature",children:"Step 4: Configure Template Feature"}),"\n",(0,l.jsxs)(n.p,{children:["The voicemail-with-email functionality is ",(0,l.jsx)(n.strong,{children:"already built into your ConnieRTC template"}),". You just need to configure it."]}),"\n",(0,l.jsx)(n.h3,{id:"update-environment-variables",children:"Update Environment Variables"}),"\n",(0,l.jsx)(n.p,{children:"In your Connie deployment, add these environment variables to Twilio Functions:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# REQUIRED ENVIRONMENT VARIABLES\n# Add these to your Twilio Functions environment\n\nADMIN_EMAIL=admin@clientdomain.com\nMAILGUN_DOMAIN=voicemail.clientdomain.com  \nMAILGUN_API_KEY=your-mailgun-sending-api-key\n\n# For multiple admin emails (separate emails sent to each):\n# ADMIN_EMAIL=admin1@domain.com,admin2@domain.com\n"})}),"\n",(0,l.jsx)(n.admonition,{title:"Use the Sending API Key",type:"warning",children:(0,l.jsxs)(n.p,{children:["The ",(0,l.jsx)(n.code,{children:"MAILGUN_API_KEY"})," must be the ",(0,l.jsx)(n.strong,{children:"API Send Key"})," from the domain's Sending keys tab, NOT the Private API key from Settings \u2192 API Keys."]})}),"\n",(0,l.jsx)(n.admonition,{title:"Multiple Admin Emails",type:"info",children:(0,l.jsxs)(n.p,{children:["To send notifications to multiple administrators, use comma-separated emails. The system sends ",(0,l.jsx)(n.strong,{children:"separate emails"})," to each recipient for better reliability."]})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"How to add environment variables:"})}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["Twilio Console \u2192 ",(0,l.jsx)(n.strong,{children:"Functions & Assets"})," \u2192 ",(0,l.jsx)(n.strong,{children:"Services"})]}),"\n",(0,l.jsx)(n.li,{children:"Select your ConnieRTC serverless service"}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Settings"})," \u2192 ",(0,l.jsx)(n.strong,{children:"Environment Variables"})]}),"\n",(0,l.jsx)(n.li,{children:"Add the three variables above"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"update-feature-configuration",children:"Update Feature Configuration"}),"\n",(0,l.jsx)(n.p,{children:"Enable the feature in your Flex configuration:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json",children:'{\n  "features": {\n    "callback_and_voicemail_with_email": {\n      "enabled": true,\n      "allow_requeue": true,\n      "max_attempts": 3,\n      "auto_select_task": false,\n      "enable_email_notifications": true\n    }\n  }\n}\n'})}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"step-5-critical-code-update",children:"Step 5: Critical Code Update"}),"\n",(0,l.jsx)(n.admonition,{title:"CRITICAL: Update Workflow SID",type:"danger",children:(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:'This is the #1 cause of "option not available" errors.'})," You MUST update the hardcoded workflow SID before deployment."]})}),"\n",(0,l.jsx)(n.h3,{id:"update-wait-experience-function",children:"Update Wait Experience Function"}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"File"}),": ",(0,l.jsx)(n.code,{children:"/serverless-functions/src/functions/features/callback-and-voicemail-with-email/studio/wait-experience.protected.js"}),(0,l.jsx)(n.br,{}),"\n",(0,l.jsx)(n.strong,{children:"Line"}),": ~135"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-javascript",children:"// TEMPORARY FIX: Hardcode workflow SID to bypass buggy queue friendlyName logic\nconst enqueuedWorkflowSid = 'WW...'; // YOUR \"Assign to Anyone\" workflow SID\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"How to find your workflow SID:"})}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["Twilio Console \u2192 ",(0,l.jsx)(n.strong,{children:"TaskRouter"})," \u2192 ",(0,l.jsx)(n.strong,{children:"Workspaces"})]}),"\n",(0,l.jsx)(n.li,{children:"Select your Flex workspace"}),"\n",(0,l.jsxs)(n.li,{children:["Click ",(0,l.jsx)(n.strong,{children:"Workflows"})]}),"\n",(0,l.jsx)(n.li,{children:'Find "Assign to Anyone" workflow'}),"\n",(0,l.jsxs)(n.li,{children:["Copy the SID (starts with ",(0,l.jsx)(n.code,{children:"WW"}),")"]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Example:"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-javascript",children:"// Before (will cause failures):\nconst enqueuedWorkflowSid = 'WW3657f8c5b384cdad9c6d37cbaedd1013'; // HHOVV workflow\n\n// After (updated for your account):\nconst enqueuedWorkflowSid = 'WW68ed6f6bc555f21e436810af747722a9'; // Your workflow\n"})}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"step-6-deploy-the-implementation",children:"Step 6: Deploy the Implementation"}),"\n",(0,l.jsx)(n.h3,{id:"deploy-serverless-functions",children:"Deploy Serverless Functions"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# Navigate to your ConnieRTC template directory\ncd serverless-functions\n\n# Deploy the updated functions with your new environment variables\nnpm run deploy\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Deployment output will show:"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"domain            custom-flex-extensions-serverless-XXXX-dev.twil.io\n...\nprotected /features/callback-and-voicemail-with-email/studio/send-voicemail-email\nprotected /features/callback-and-voicemail-with-email/studio/wait-experience\n"})}),"\n",(0,l.jsx)(n.admonition,{title:"Note Your Deployment Domain",type:"tip",children:(0,l.jsxs)(n.p,{children:["Copy the domain URL (e.g., ",(0,l.jsx)(n.code,{children:"custom-flex-extensions-serverless-4044-dev.twil.io"}),"). You'll need this for Studio Flow configuration and monitoring."]})}),"\n",(0,l.jsx)(n.h3,{id:"verify-environment-variables-deployed",children:"Verify Environment Variables Deployed"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# List deployed environment variables\ntwilio api:serverless:v1:services:environments:variables:list \\\n  --service-sid ZS... \\\n  --environment-sid ZE...\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Look for:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"ADMIN_EMAIL"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"MAILGUN_DOMAIN"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"MAILGUN_API_KEY"})}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"apply-infrastructure-changes",children:"Apply Infrastructure Changes"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'# Navigate to terraform directory\ncd infra-as-code/terraform/environments/default\n\n# Enable the callback-and-voicemail-with-email module in your tfvars\n# Add this line to your local.tfvars:\n# callback_and_voicemail_with_email_enabled = true\n\n# Apply the changes\nterraform plan -var-file="local.tfvars"\nterraform apply -var-file="local.tfvars"\n'})}),"\n",(0,l.jsx)(n.p,{children:"This creates:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u2705 TaskRouter workflow for callback/voicemail routing"}),"\n",(0,l.jsx)(n.li,{children:"\u2705 Studio Flow with email integration"}),"\n",(0,l.jsx)(n.li,{children:"\u2705 All required serverless functions"}),"\n"]}),"\n",(0,l.jsxs)(n.admonition,{title:"Correct Terminology",type:"info",children:[(0,l.jsxs)(n.p,{children:["In the Studio Flow Send to Flex widget, the field is called ",(0,l.jsx)(n.strong,{children:'"Hold Music TwiML URL"'}),' (NOT "Wait URL"). This URL handles the caller experience while waiting in queue.']}),(0,l.jsx)(n.h3,{id:"connect-to-phone-number",children:"Connect to Phone Number"}),(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["Twilio Console \u2192 ",(0,l.jsx)(n.strong,{children:"Phone Numbers"})," \u2192 ",(0,l.jsx)(n.strong,{children:"Active Numbers"})]}),"\n",(0,l.jsx)(n.li,{children:"Click your client's phone number"}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Voice Configuration"})," \u2192 ",(0,l.jsx)(n.strong,{children:"A call comes in"})]}),"\n",(0,l.jsxs)(n.li,{children:["Select the new Studio Flow: ",(0,l.jsx)(n.strong,{children:'"Template Example Callback With Email Flow"'})]}),"\n",(0,l.jsx)(n.li,{children:"Save configuration"}),"\n"]}),(0,l.jsxs)(n.admonition,{title:"Studio Flow Not Appearing?",type:"tip",children:[(0,l.jsx)(n.p,{children:"If the Studio Flow doesn't appear in the dropdown, use the CLI method:"}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'# Create flow JSON file\ncat > callback-voicemail-email-flow.json << \'EOF\'\n{\n  "description": "Callback and Voicemail with Email Flow",\n  "states": [\n    {\n      "name": "Trigger",\n      "type": "trigger",\n      "transitions": [\n        {"event": "incomingMessage"},\n        {"next": "send_to_flex_1", "event": "incomingCall"},\n        {"event": "incomingConversationMessage"},\n        {"event": "incomingRequest"},\n        {"event": "incomingParent"}\n      ],\n      "properties": {"offset": {"x": -70, "y": -60}}\n    },\n    {\n      "name": "send_to_flex_1",\n      "type": "send-to-flex",\n      "transitions": [\n        {"event": "callComplete"},\n        {"event": "failedToEnqueue"},\n        {"event": "callFailure"}\n      ],\n      "properties": {\n        "waitUrl": "https://YOUR-DEPLOYMENT-DOMAIN/features/callback-and-voicemail-with-email/studio/wait-experience",\n        "offset": {"x": 170, "y": 100},\n        "workflow": "YOUR-WORKFLOW-SID",\n        "channel": "voice",\n        "attributes": "{\\"call_sid\\": \\"{{trigger.call.CallSid}}\\", \\"callBackData\\": {\\"attempts\\": 0}}",\n        "waitUrlMethod": "POST"\n      }\n    }\n  ],\n  "initial_state": "Trigger",\n  "flags": {"allow_concurrent_calls": true}\n}\nEOF\n\n# Replace YOUR-DEPLOYMENT-DOMAIN and YOUR-WORKFLOW-SID\n\n# Create the flow\ntwilio api:studio:v2:flows:create \\\n  --friendly-name "Callback and Voicemail with Email Flow" \\\n  --status published \\\n  --definition "$(cat callback-voicemail-email-flow.json)"\n'})})]})]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"step-7-automated-testing",children:"Step 7: Automated Testing"}),"\n",(0,l.jsx)(n.h3,{id:"pre-deployment-test-script",children:"Pre-Deployment Test Script"}),"\n",(0,l.jsx)(n.p,{children:"Use the comprehensive test script to validate your deployment:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'# Navigate to your ConnieRTC directory\ncd /path/to/connieRTC-basecamp\n\n# Set your configuration variables\nexport ACCOUNT_SID="AC..."\nexport PHONE_NUMBER="+1..."\nexport ADMIN_EMAIL="admin@clientdomain.com"\nexport MAILGUN_DOMAIN="voicemail.clientdomain.com" \nexport MAILGUN_API_KEY="your-domain-sending-api-key"\nexport DEPLOYMENT_DOMAIN="custom-flex-extensions-serverless-XXXX-dev.twil.io"\nexport WORKFLOW_SID="WW..."\n\n# Run the comprehensive test\n./test-voicemail-email-workflow.sh\n'})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"The script validates:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u2705 Twilio CLI configuration"}),"\n",(0,l.jsx)(n.li,{children:"\u2705 Mailgun API credentials"}),"\n",(0,l.jsx)(n.li,{children:"\u2705 Serverless function deployment"}),"\n",(0,l.jsx)(n.li,{children:"\u2705 Environment variables"}),"\n",(0,l.jsx)(n.li,{children:"\u2705 Studio Flow configuration"}),"\n"]}),"\n",(0,l.jsx)(n.admonition,{title:"Automated Verification",type:"tip",children:(0,l.jsx)(n.p,{children:"This test script catches 90% of configuration issues before manual testing, saving significant troubleshooting time."})}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"step-8-manual-test-your-implementation",children:"Step 8: Manual Test Your Implementation"}),"\n",(0,l.jsx)(n.h3,{id:"complete-test-workflow",children:"Complete Test Workflow"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.strong,{children:"Call the client's number"})}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Listen to the greeting"})," and wait for options"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Press * (star)"})," during hold music"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Press 2"})," for voicemail option"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Leave a test message"})," (say your name and timestamp)"]}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.strong,{children:"Hang up"})}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"expected-results",children:"Expected Results"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"In Flex:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Voicemail task appears in the queue"}),"\n",(0,l.jsx)(n.li,{children:"Task contains recording and transcription"}),"\n",(0,l.jsx)(n.li,{children:"Agents can handle normally"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"In Email:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Email arrives at admin address within 1-2 minutes"}),"\n",(0,l.jsx)(n.li,{children:'Subject: "New Voicemail from [phone number]"'}),"\n",(0,l.jsx)(n.li,{children:"Body includes all call details and transcription"}),"\n",(0,l.jsx)(n.li,{children:".wav audio file attached"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Sample Email Content:"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"New voicemail received:\n\nFrom: +15105551234\nTo: +18005551234\nDate: 2024-01-15T14:30:00.000Z\nRecording ID: REabc123...\n\nTranscription:\nHi, this is John testing the voicemail system at 2:30 PM.\n\nThe audio recording is attached to this email.\n\n---\nThis is an automated message. Please do not reply.\n"})}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"step-9-production-optimization",children:"Step 9: Production Optimization"}),"\n",(0,l.jsx)(n.h3,{id:"monitoring-setup",children:"Monitoring Setup"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Function URLs for Real-Time Monitoring:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Email Function Logs"}),": ",(0,l.jsx)(n.code,{children:"https://[YOUR-DEPLOYMENT-DOMAIN]/features/callback-and-voicemail-with-email/studio/send-voicemail-email"})]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Call Flow Logs"}),": ",(0,l.jsx)(n.code,{children:"https://[YOUR-DEPLOYMENT-DOMAIN]/features/callback-and-voicemail-with-email/studio/wait-experience"})]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Access logs via:"})}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["Twilio Console \u2192 ",(0,l.jsx)(n.strong,{children:"Functions & Assets"})," \u2192 ",(0,l.jsx)(n.strong,{children:"Services"})," \u2192 Your Service \u2192 ",(0,l.jsx)(n.strong,{children:"Environment"})," \u2192 ",(0,l.jsx)(n.strong,{children:"Live Logs"})]}),"\n",(0,l.jsxs)(n.li,{children:["Or use CLI: ",(0,l.jsx)(n.code,{children:"twilio serverless:logs --service-sid ZS... --environment-sid ZE..."})]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Check these regularly:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Mailgun dashboard for delivery rates"}),"\n",(0,l.jsx)(n.li,{children:"Twilio Function logs for errors"}),"\n",(0,l.jsx)(n.li,{children:"DNS record status"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Monthly maintenance:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Test complete voicemail-to-email flow"}),"\n",(0,l.jsx)(n.li,{children:"Review Mailgun usage and costs"}),"\n",(0,l.jsx)(n.li,{children:"Verify DNS records unchanged"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"performance-considerations",children:"Performance Considerations"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"File Size Handling:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Files under 20MB: Attached directly"}),"\n",(0,l.jsx)(n.li,{children:"Files over 20MB: Download link provided"}),"\n",(0,l.jsx)(n.li,{children:"Automatic timeout protection"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Email Delivery:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Typical delivery: 1-5 seconds"}),"\n",(0,l.jsx)(n.li,{children:"Free tier: 100 emails/day"}),"\n",(0,l.jsx)(n.li,{children:"Paid plans available for higher volume"}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,l.jsx)(n.h3,{id:"common-failure-points--solutions",children:"Common Failure Points & Solutions"}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"Error"}),(0,l.jsx)(n.th,{children:"Cause"}),(0,l.jsx)(n.th,{children:"Solution"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:'"Option not available at this time"'}),(0,l.jsx)(n.td,{children:"Wrong/missing workflow SID"}),(0,l.jsx)(n.td,{children:"Update wait-experience.protected.js line 135"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"401/403 email errors"}),(0,l.jsx)(n.td,{children:"Wrong API key type"}),(0,l.jsx)(n.td,{children:"Use domain sending key, not private key"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"Flow not in phone config"}),(0,l.jsx)(n.td,{children:"Creation failed in Console"}),(0,l.jsx)(n.td,{children:"Use CLI method in Step 5"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"No environment vars in Console"}),(0,l.jsx)(n.td,{children:"Browser cache/wrong environment"}),(0,l.jsx)(n.td,{children:"Verify with CLI, refresh browser"})]})]})]}),"\n",(0,l.jsx)(n.h3,{id:"no-email-received",children:"No Email Received"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"First check for authentication errors:"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# Test API directly\ncurl -s -w \"\\nHTTP Status: %{http_code}\\n\" --user \"api:[YOUR_KEY]\" \\\n    https://api.mailgun.net/v3/[YOUR_DOMAIN]/messages \\\n    -F from='Test <test@[YOUR_DOMAIN]>' \\\n    -F to='[ADMIN_EMAIL]' \\\n    -F subject='Debug Test' \\\n    -F text='Testing email delivery'\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Check Mailgun logs:"})}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["Mailgun dashboard \u2192 ",(0,l.jsx)(n.strong,{children:"Logs"})]}),"\n",(0,l.jsx)(n.li,{children:"Look for your test email"}),"\n",(0,l.jsx)(n.li,{children:"Check delivery status"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Common issues:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"DNS records not propagated (wait 24 hours)"}),"\n",(0,l.jsx)(n.li,{children:"Wrong API key format (using private key instead of sending key)"}),"\n",(0,l.jsx)(n.li,{children:"Admin email in spam folder"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"email-without-attachment",children:"Email Without Attachment"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Check Function logs:"})}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["Twilio Console \u2192 ",(0,l.jsx)(n.strong,{children:"Functions"})," \u2192 ",(0,l.jsx)(n.strong,{children:"Logs"})]}),"\n",(0,l.jsx)(n.li,{children:"Look for voicemail function execution"}),"\n",(0,l.jsx)(n.li,{children:"Check for download errors"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Common issues:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Recording URL not accessible"}),"\n",(0,l.jsx)(n.li,{children:"Network timeout during download"}),"\n",(0,l.jsx)(n.li,{children:"File size exceeded limits"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"voicemail-task-not-created",children:"Voicemail Task Not Created"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"This indicates email integration broke the core functionality:"})}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:"Check Function logs for errors"}),"\n",(0,l.jsx)(n.li,{children:"Verify all environment variables present"}),"\n",(0,l.jsx)(n.li,{children:"Test with original callback-and-voicemail feature"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Quick fix:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Disable email temporarily by removing ADMIN_EMAIL environment variable"}),"\n",(0,l.jsx)(n.li,{children:"Redeploy functions"}),"\n",(0,l.jsx)(n.li,{children:"Test core voicemail functionality"}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"cost-planning",children:"Cost Planning"}),"\n",(0,l.jsx)(n.h3,{id:"mailgun-costs",children:"Mailgun Costs"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Free tier:"})," 100 emails/day"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Flex plans:"})," Start at $35/month for 1,250/month"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Pay-as-you-go:"})," Available for variable volume"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"estimating-volume",children:"Estimating Volume"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Average organization: 5-20 voicemails/day"}),"\n",(0,l.jsx)(n.li,{children:"High-volume organizations: 50+ voicemails/day"}),"\n",(0,l.jsx)(n.li,{children:"Plan accordingly for your client's expected usage"}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"security-best-practices",children:"Security Best Practices"}),"\n",(0,l.jsx)(n.h3,{id:"api-key-management",children:"API Key Management"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Store keys in Twilio Functions environment variables only"}),"\n",(0,l.jsx)(n.li,{children:"Never commit keys to code repositories"}),"\n",(0,l.jsx)(n.li,{children:"Rotate keys quarterly"}),"\n",(0,l.jsx)(n.li,{children:"Use separate keys for testing vs production"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"email-security",children:"Email Security"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Use dedicated subdomain (voicemail.domain.com)"}),"\n",(0,l.jsx)(n.li,{children:"Implement all DNS security records (SPF, DKIM, DMARC)"}),"\n",(0,l.jsx)(n.li,{children:"Monitor DNS for unauthorized changes"}),"\n",(0,l.jsx)(n.li,{children:"Set up proper reverse DNS"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"data-privacy",children:"Data Privacy"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Voicemail recordings contain sensitive data"}),"\n",(0,l.jsx)(n.li,{children:"Ensure Mailgun account complies with client's privacy requirements"}),"\n",(0,l.jsx)(n.li,{children:"Consider email encryption for sensitive environments"}),"\n",(0,l.jsx)(n.li,{children:"Implement retention policies"}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"professional-services-available",children:"Professional Services Available"}),"\n",(0,l.jsxs)(n.admonition,{title:"Need Implementation Help?",type:"tip",children:[(0,l.jsx)(n.p,{children:"Our team can handle the complete setup including:"}),(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Mailgun account configuration"}),"\n",(0,l.jsx)(n.li,{children:"DNS record setup"}),"\n",(0,l.jsx)(n.li,{children:"Template deployment and testing"}),"\n",(0,l.jsx)(n.li,{children:"Client training and documentation"}),"\n"]}),(0,l.jsx)(n.p,{children:"Contact your Connie representative for professional services options."})]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.p,{children:"Your client now has enterprise-grade voicemail functionality with automated email notifications and professional caller experience!"}),"\n",(0,l.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"./advanced-email-config",children:"Set up additional email recipients"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"./email-customization",children:"Configure branded email templates"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"./monitoring-guide",children:"Monitor and maintain your deployment"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(d,{...e})}):d(e)}},90654:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/mailgun-sending-key-details-d3f5c11c672db4f3c327191434837466.png"}}]);